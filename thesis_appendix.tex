\chapter{Applicability of the Fisher Matrix}
\label{app:fisher_valid}

As established in Sec.~\ref{sec:fisher_prereq}, one requirement for the Fisher
Matrix to be valid is that the observables (\ie the bin counts for PINGU) are
described by linear functions of the parameters, hence the partial derivatives
entering (\ref{eqn:fisher_def}) can be considered to be constant within the
considered range. To quantify the non-linearity, one can define the quantity
\begin{equation}
 \Upsilon_n(p_i) = \left(N_n(p_{i,\,\mathrm{fid}} + \sigma_{p_i}) -
                          N_n(p_{i,\,\mathrm{fid}}) +
                     \frac{\partial N_n}{\partial p_i}\sigma_{p_i}\right)
                       \bigg/ N_n(p_{i,\,\mathrm{fid}}) \quad,
 \label{eqn:non-lin}
\end{equation}
describing the relative contribution of the non-linear terms to the variation
of the event count $N_b$ in bin $b$ as a function of the parameter $p_i$ over
its uncertainty range $p_{i,\,\mathrm{fid}} \pm \sigma_{p_i}$.

As one can see from Figs.~\ref{fig:nonlinearities1} and
\ref{fig:nonlinearities2}, for the simple scaling parameters like the mass
hierarchy $h$ or the overall normalisation $n_\aeff$ non-linearities are on the
order of the machine precision. But also for the physics parameters they are
typically smaller than $10^{-3}$, hence the requirement of linearity is well
fulfilled.

For means of illustration, the actual dependence of all bin entries on the
systematic parameters is shown as well. By eye, deviations from linearity can
only be recognised for \dm{31} and the energy scale. Since both shift the
sinusoidal oscillation pattern in energy non-linearities have to be expected,
however they only occur on a scale conceivably larger than the actual
uncertainty range.

\begin{figure}[p]
 \centering
 \includegraphics[width=\linewidth]{hierarchy}
 \includegraphics[width=\linewidth]{deltam31}
 \includegraphics[width=\linewidth]{theta23}
 \includegraphics[width=\linewidth]{theta13}
 \includegraphics[width=\linewidth]{energy_scale}
 \caption{\emph{Left:} Relative values of all bin entries in the analysis
  histograms as functions of the systematic parameters. The the entries at the 
  fiducial parameter values are set to one. The vertical lines indicate the full
  error range as listed in Tab.~\ref{tab:baseline_results}. \\
  \emph{Right:} Histograms of the non-linearities $\Upsilon$ of the bin counts
  as functions of different systematic parameters (see equation
  (\ref{eqn:non-lin})).}
 \label{fig:nonlinearities1}
\end{figure}

\begin{figure}[p]
 \centering
 \includegraphics[width=\linewidth]{a_eff_scale_flat}
 \includegraphics[width=\linewidth]{nu_rel_xsec_scale}
 \includegraphics[width=\linewidth]{nue_numu_flux_scale}
 \includegraphics[width=\linewidth]{a_eff_scale}
 \includegraphics[width=\linewidth]{PID_offset}
 \caption{Same as Fig.~\ref{fig:nonlinearities1} for the remaining parameters.}
 \label{fig:nonlinearities2}
\end{figure}


\chapter{Oscillation Probabilities}
\label{app:oscillation}

\section*{\refstepcounter{section}\thesection\enskip Baseline Settings}

\begin{figure}[h]
 \centering
 \includegraphics[width=0.95\textwidth]{osc_ds_nue_to_nue}
 \caption{Oscillation probabilities for $\nue \to \nue$ (top) and $\nuebar \to
          \nuebar$ (bottom) for normal and inverted hierarchy.}
\end{figure}


\begin{figure}[t!]
 \centering
 \includegraphics[width=0.95\textwidth]{osc_ds_nue_to_numu}
 \caption{Oscillation probabilities for $\nue \to \numu$ (top) and $\nuebar \to
          \numubar$ (bottom) for normal and inverted hierarchy.}
\end{figure}

\begin{figure}[b!]
 \centering
 \includegraphics[width=0.95\textwidth]{osc_ds_nue_to_nutau}
 \caption{Oscillation probabilities for $\nue \to \nutau$ (top) and $\nuebar \to
          \nutaubar$ (bottom) for normal and inverted hierarchy.}
\end{figure}

\begin{figure}[t!]
 \centering
 \includegraphics[width=0.95\textwidth]{osc_ds_numu_to_nue}
 \caption{Oscillation probabilities for $\numu \to \nue$ (top) and $\numubar \to
          \nuebar$ (bottom) for normal and inverted hierarchy.}
\end{figure}

\begin{figure}[b!]
 \centering
 \includegraphics[width=0.95\textwidth]{osc_ds_numu_to_numu}
 \caption{Oscillation probabilities for $\numu \to \numu$ (top) and $\numubar
          \to \numubar$ (bottom) for normal and inverted hierarchy.}
\end{figure}


\begin{figure}[t!]
 \centering
 \includegraphics[width=0.95\textwidth]{osc_ds_numu_to_nutau}
 \caption{Oscillation probabilities for $\numu \to \nutau$ (top) and $\numubar
          \to \nutaubar$ (bottom) for normal and inverted hierarchy.}
\end{figure}

\clearpage
\section*{\refstepcounter{section}\thesection\enskip Scanning the fiducial value
of \thet{23}}

\begin{figure}[b!]
 \centering
 \includegraphics[width=0.9\linewidth]{P_NH_and_diff_numu_to_nue_th23_41deg}
 \includegraphics[width=0.9\linewidth]{P_NH_and_diff_numu_to_nue_th23_45deg}
 \includegraphics[width=0.9\linewidth]{P_NH_and_diff_numu_to_nue_th23_48deg}
 \includegraphics[width=0.9\linewidth]{P_NH_and_diff_numu_to_nue_th23_51deg}
 \caption{Probabilities for $\numu\to\nue$ oscillations in normal mass
  hierarchy (left column) and difference between normal and inverted hierarchy
  oscillation probabilities (right column) for different values of \thet{23} in
  both octants.}
 \label{fig:osc_probs_scan_th23}
\end{figure}


\chapter{Parametrisations of the Detector Resolutions}
\label{app:reco_params}

The full parametrisations of the reconstruction performances will be listed in
form of the actual \papa input. These are nested dictionaries giving the
resolutions in energy (\texttt{'e'}) and \coszen (\texttt{'coszen'}) for all
four interaction channels: \nue, \numu, and \nutau CC (\texttt{'nue'},
\texttt{'numu'}, and \texttt{'nutau'}, respectively) and \nux NC
(\texttt{'NC'}). For each of those the resolution is given by the five
parameters \texttt{'fraction'}, \texttt{'loc1'}, \texttt{'loc2'},
\texttt{'width1'}, and \texttt{'width2'}, corresponding to $f$, $\mu_1$,
$\mu_2$, $\sigma_1$ and $\sigma_2$ in (\ref{eqn:reco_param}).

The actual function definitions for the five parameters is then supplied as a
text string that can be interpreted as a python function by python's
\texttt{eval()} function. In those definitions, \texttt{'n'} is a shorthand
for the numpy library \cite{numpy} used for most of the numerical operations in
\papa.

\section*{\refstepcounter{section}\thesection\enskip Baseline Settings}

\small{\VerbatimInput{figs/reco_param/reco_default.json}}

\section*{\refstepcounter{section}\label{app:reco_V15}\thesection\enskip
Geometry
V15 (Noiseless)}

\small{\VerbatimInput{figs/reco_param/reco_V15.json}}

\chapter{PID Functions}
\label{app:pid}

\section*{\refstepcounter{section}\thesection\enskip Baseline Settings}

The particle identification is a binary decision, thus only the track
identification probabilities $P_{\mathrm{channel} \to \mathrm{track}}$ are
listed:
\begin{eqnarray}
 P_{\nue\to\mathrm{track}}(E) &=&
   0.192 \gauss{\log_{10}(E[\mathrm{GeV}])}{0.878}{0.404} + 0.0309 \\
 P_{\numu\to\mathrm{track}}(E) &=&
   \frac{0.687}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{0.683}{0.183}} + 0.0585 \\
 P_{\nutau\to\mathrm{track}}(E) &=&
   0.197 \gauss{\log_{10}(E[\mathrm{GeV}])}{1.28}{0.466} + 0.0732 \\
 P_{\nux\,\mathrm{NC}\to\mathrm{track}}(E) &=&
   0.171 \gauss{\log_{10}(E[\mathrm{GeV}])}{1.37}{0.483} + 0.0339
\end{eqnarray}
The cascade identification probabilities are given by $P_{\mathrm{channel} \to
\mathrm{cascade}} = 1 - P_{\mathrm{channel} \to \mathrm{track}}$.

\section*{\refstepcounter{section}\label{app:PID_threechannel}\thesection\enskip
High-Purity Event Classification}

\begin{figure}[h!]
 \centering
 \includegraphics[width=0.495\linewidth]{PID_V15_trck}
 \includegraphics[width=0.495\linewidth]{PID_V15_cscd}
 \caption{Classification efficiencies for the high-purity track (left) and
          cascade (right) selections for PINGU V15, similar to
          Fig.~\ref{fig:PID}.}
 \label{fig:PID_threechannel}
\end{figure}

The particle identification is done by selecting high-purity track and cascade
samples, events ending up in neither sample are classified as ``unidentified'':
\begin{eqnarray}
 P_{\nue\to\mathrm{track}}(E) &=&
   0.0481 \gauss{\log_{10}(E[\mathrm{GeV}])}{0.904}{0.265} + 0.0350 \\
 P_{\nue\to\mathrm{cascade}}(E) &=&
   \frac{0.945}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{0.922}{0.180}} + 0.0264 \\
 P_{\numu\to\mathrm{track}}(E) &=&
   \frac{0.782}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{0.808}{0.135}} + 0.0507 \\
 P_{\numu\to\mathrm{cascade}}(E) &=&
   \frac{0.103}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{0.499}{0.127}} + 0.0223 \\
 P_{\nutau\to\mathrm{track}}(E) &=&
   \frac{0.125}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{0.882}{0.120}} + 0.0396 \\
 P_{\nutau\to\mathrm{cascade}}(E) &=&
   \frac{0.811}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{1.19}{0.200}} + 0.0163 \\
 P_{\nux\,\mathrm{NC}\to\mathrm{track}}(E) &=&
   \frac{0.0344}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{0.939}{0.0516}} + 0.0439
\\
 P_{\nux\,\mathrm{NC}\to\mathrm{cascade}}(E) &=&
   \frac{0.771}{\stepfunc{\log_{10}(E[\mathrm{GeV}])}{1.34}{0.216}} + 0.0202 
\end{eqnarray}
The fit of these functions to data is shown in Fig.~\ref{fig:PID_threechannel}.


\chapter{Full Error Listings}
\label{app:fisher_output}

Here the full error lists, similar to Tab.~\ref{tab:baseline_results}, for
various detector settings and sub-channels will be collected. These have
not been included in the main text for the sake of better readability. For a
description how to read the tables, refer to the explanations given for
Tab.~\ref{tab:baseline_results} in Sec.~\ref{sec:results_baseline}.

\section*{\refstepcounter{section}\label{app:fisher_baseline}\thesection\enskip
Baseline Settings}

\begin{table}[h!]
 \caption{Same as Tab.~\ref{tab:baseline_results}, but for the track channel
  only}
 \begin{center}
  \small{\input{figs/fishers/baseline_trck.tex}}
 \end{center}
\end{table}

\begin{table}[h!]
 \caption{Same as Tab.~\ref{tab:baseline_results}, but for the cascade channel
  only}
 \begin{center}
  \small{\input{figs/fishers/baseline_cscd.tex}}
 \end{center}
\end{table}

% \afterpage{\clearpage}
\FloatBarrier
\section*{\refstepcounter{section}\label{app:fisher_nhtrue}
\thesection\enskip Normal Mass Hierarchy as Truth}

\begin{table}[h!]
 \caption{Full error listings for the combined analysis of tracks and cascades
  when assuming true normal mass hierarchy.}
 \label{tab:nh_true_results}
 \begin{center}
  \small{\input{figs/fishers/nh_true.tex}}
 \end{center}
\end{table}

\begin{table}[h!]
 \caption{Same as Tab.~\ref{tab:nh_true_results}, but for the track channel
  only}
 \begin{center}
  \small{\input{figs/fishers/nh_true_trck.tex}}
 \end{center}
\end{table}

\begin{table}[h!]
 \caption{Same as Tab.~\ref{tab:nh_true_results}, but for the cascade channel
  only}
 \begin{center}
  \small{\input{figs/fishers/nh_true_cscd.tex}}
 \end{center}
\end{table}


\clearpage
\section*{\refstepcounter{section}\label{app:fisher_threechannel}
\thesection\enskip High-Purity Event Classification}

\begin{table}[h!]
 \caption{Full error listings for the high-purity track channel, see
Sec.~\ref{sec:results_includeunkn}.}
 \begin{center}
  \small{\input{figs/fishers/threechannel_PID_trck.tex}}
 \end{center}
\end{table}

\begin{table}[h!]
 \caption{Full error listings for the standard cascade channel (\ie cascades
are all events not identified as tracks), see
Sec.~\ref{sec:results_includeunkn}.}
 \label{tab:fisher_PID_cscd_nontracks}
 \begin{center}
  \small{\input{figs/fishers/twochannel_PID_cscd.tex}}
 \end{center}
\end{table}

% \begin{table}[h!]
%  \caption{Full error listings for the high-purity track channel, see
% Sec.~\ref{sec:results_includeunkn}.}
%  \begin{center}
%   \small{\input{figs/fishers/twochannel_PID_trck.tex}}
%  \end{center}
% \end{table}


\begin{table}[h!]
 \caption{Full error listings for the high-purity cascade channel, see
Sec.~\ref{sec:results_includeunkn}.}
 \begin{center}
  \smaller{\input{figs/fishers/threechannel_PID_cscd.tex}}
 \end{center}
\end{table}

\begin{table}[h!]
 \caption{Full error listings for the sample of unidentified events, see
Sec.~\ref{sec:results_includeunkn}.}
 \begin{center}
  \smaller{\input{figs/fishers/threechannel_PID_unkn.tex}}
 \end{center}
\end{table}

\enlargethispage{2cm}
\begin{table}[h!]
 \caption{Full error listings for the high-purity cascade channel combined with
the unidentified sample after Fisher matrix evaluation.}
 \label{tab:fisher_PID_cscd_twochan}
 \begin{center}
  \smaller{\input{figs/fishers/threechannel_PID_cscd_plus_unkn.tex}}
 \end{center}
\end{table}

\clearpage
\section*{\refstepcounter{section}\label{app:fisher_mDOM}
\thesection\enskip PINGU equipped with mDOMs}

\begin{table}[h!]
 \caption{Full error listings for PINGU assuming reconstruction and particle
          identification as in geometry V15, \ie no module noise.}
 \label{tab:mDOM_comb}
 \begin{center}
  \smaller{\input{figs/fishers/mDOM.tex}}
 \end{center}
\end{table}

\begin{table}[h!]
 \caption{Same as Tab.~\ref{tab:mDOM_comb}, but for the track channel
  only}
 \begin{center}
  \smaller{\input{figs/fishers/mDOM_trck.tex}}
 \end{center}
\end{table}

\enlargethispage{2cm}
\begin{table}[h!]
 \caption{Same as Tab.~\ref{tab:mDOM_comb}, but for the cascade channel
  only}
 \begin{center}
  \smaller{\input{figs/fishers/mDOM_cscd.tex}}
 \end{center}
\end{table}

\clearpage
\section*{\refstepcounter{section}\label{app:fisher_JUNO}
\thesection\enskip JUNO}

\begin{table}[h!]
 \caption{Full error listings for JUNO including prior knowledge on the
  oscillation parameters as given in \cite{Fogli}.}
 \label{tab:JUNO_priors}
 \begin{center}
  \smaller{\input{figs/fishers/JUNO_priors.tex}}
 \end{center}
\end{table}

\begin{table}[h!]
 \caption{Same as Tab.~\ref{tab:JUNO_priors}, but without a prior on \dm{21}.}
 \label{tab:JUNO_no_prior_dm21}
 \begin{center}
  \smaller{\input{figs/fishers/JUNO_no_prior_dm21.tex}}
 \end{center}
\end{table}
